# ğŸŒ± Plant Seedlings Classification with ResNet18 & ResNet34 Ensemble

æœ¬é¡¹ç›®åŸºäº Kaggle çš„ [Plant Seedlings Classification](https://www.kaggle.com/competitions/plant-seedlings-classification) æ¯”èµ›ï¼Œé€šè¿‡è®­ç»ƒæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå¯¹ 12 ç±»æ¤ç‰©å¹¼è‹—å›¾åƒè¿›è¡Œåˆ†ç±»ï¼Œæœ€ç»ˆèåˆ ResNet18 å’Œ ResNet34 æ¨¡å‹ï¼Œè¾¾åˆ° **0.96347** çš„æäº¤å‡†ç¡®ç‡ã€‚

## ğŸš€ é¡¹ç›®äº®ç‚¹

æ•°æ®é¢„å¤„ç†ä¸å¢å¼º

å®ç°åŒ…æ‹¬éšæœºè£å‰ªã€æ—‹è½¬ã€æ°´å¹³ç¿»è½¬ã€é¢œè‰²æŠ–åŠ¨ç­‰å¤šç§æ•°æ®å¢å¼ºç­–ç•¥ï¼Œæå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›ã€‚

è®¾è®¡è®­ç»ƒ/éªŒè¯é›†åˆ’åˆ†æ–¹æ¡ˆï¼Œä¿è¯ç±»åˆ«åˆ†å¸ƒå‡è¡¡ã€‚

æ¨¡å‹è®¾è®¡ä¸è®­ç»ƒ

åŸºäºPyTorchæ„å»ºResNet18å’ŒResNet34éª¨å¹²ç½‘ç»œï¼Œé‡‡ç”¨é¢„è®­ç»ƒæƒé‡ï¼Œè¿›è¡Œè¿ç§»å­¦ä¹ ã€‚

è®¾è®¡å†»ç»“ä¸è§£å†»ç­–ç•¥ï¼Œé€å±‚å¾®è°ƒï¼Œæ˜¾è‘—æå‡æ¨¡å‹è¡¨ç°ã€‚

å®ç°å¤šç§ä¼˜åŒ–å™¨ï¼ˆSGDã€Momentumã€AdaGradã€Adamï¼‰å¯¹æ¯”ï¼Œæœ€ç»ˆé€‰ç”¨AdaGradã€‚

é›†æˆå­¦ä¹ ç‡è°ƒåº¦å™¨ï¼ˆReduceLROnPlateauï¼‰ï¼Œè‡ªåŠ¨è°ƒèŠ‚å­¦ä¹ ç‡ï¼Œæå‡æ”¶æ•›é€Ÿåº¦å’Œç¨³å®šæ€§ã€‚

æ¨¡å‹èåˆä¸æ€§èƒ½æå‡

å®ç°ResNet18ä¸ResNet34æ¨¡å‹è¾“å‡ºæ¦‚ç‡å¹³å‡èåˆï¼Œæå‡åˆ†ç±»å‡†ç¡®ç‡ã€‚
å®ç°æµ‹è¯•æ—¶å¢å¼ºï¼ˆTTAï¼‰ï¼Œé€šè¿‡å¤šæ¬¡å¢å¼ºé¢„æµ‹æ¦‚ç‡å¹³å‡ï¼Œè¿›ä¸€æ­¥æé«˜æµ‹è¯•å‡†ç¡®ç‡ã€‚

æ¨¡å‹è¯„ä¼°ä¸é”™è¯¯åˆ†æ

ç»˜åˆ¶æ··æ·†çŸ©é˜µï¼Œå®šä½æ¨¡å‹æ˜“æ··æ·†ç±»åˆ«ï¼ŒæŒ‡å¯¼åç»­é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚
æ”¶é›†é”™è¯¯åˆ†ç±»æ ·æœ¬ï¼Œåˆ†æå¤±è´¥æ¡ˆä¾‹ï¼Œåˆ¶å®šæ•°æ®å¢å¼ºåŠæ¨¡å‹è°ƒæ•´ç­–ç•¥ã€‚

æäº¤æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆ

è®¾è®¡æ¨ç†è„šæœ¬ï¼Œå®ç°æ‰¹é‡é¢„æµ‹ä¸ç»“æœåç¼–ç ï¼Œè‡ªåŠ¨ç”Ÿæˆç¬¦åˆKaggleæ ¼å¼çš„æäº¤æ–‡ä»¶ã€‚
å®Œæˆå¤šæ¬¡Kaggleæäº¤ï¼Œå‡†ç¡®ç‡ç¨³å®šè¾¾åˆ°95%ä»¥ä¸Šã€‚

ä»£ç æ¨¡å—åŒ–ä¸å·¥ç¨‹åŒ–

æ•°æ®åŠ è½½ã€é¢„å¤„ç†ã€æ¨¡å‹å®šä¹‰ã€è®­ç»ƒã€æ¨ç†åˆ†ç¦»æˆç‹¬ç«‹æ¨¡å—ï¼Œä¾¿äºç»´æŠ¤å’Œå¤ç”¨ã€‚
è¯¦ç»†æ³¨é‡Šä¸READMEæ–‡æ¡£ï¼Œç¡®ä¿é¡¹ç›®æ˜“äºä»–äººç†è§£å’Œå¤ç°ã€‚


## ğŸ§  æ¨¡å‹ç»“æ„

- `ResNet18` å’Œ `ResNet34`ï¼Œé¢„è®­ç»ƒè‡ª ImageNet
- è§£å†» layer4 + fc å±‚è¿›è¡Œå¾®è°ƒ
- æœ€ç»ˆé¢„æµ‹ç»“æœä¸ºä¸¤ä¸ªæ¨¡å‹ softmax æ¦‚ç‡åŠ æƒå¹³å‡


## ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

plant_classifier/

â”œâ”€â”€ data/ # å­˜æ”¾è®­ç»ƒ/æµ‹è¯•å›¾åƒï¼ˆæœ¬åœ°ï¼‰Kaggleæœ¬åœ°å¯ä¸‹è½½ï¼Œè¿™é‡Œä¸ä¸Šä¼ äº†

â”‚ â””â”€â”€ train/ # 12 ä¸ªç±»åˆ«æ–‡ä»¶å¤¹

â”œâ”€â”€ model.py # æ„å»ºæ¨¡å‹ç»“æ„ï¼ˆæ”¯æŒ resnet18/resnet34ï¼‰

â”œâ”€â”€ train_resnet18.py # è®­ç»ƒ ResNet18 ä¸»é€»è¾‘

â”œâ”€â”€ train_resnet34.py # è®­ç»ƒ ResNet34 ä¸»é€»è¾‘

â”œâ”€â”€ ensemble.py # èåˆä¸¤ä¸ªæ¨¡å‹ç”Ÿæˆæäº¤æ–‡ä»¶

â”œâ”€â”€ evaluate.py # TTAã€æ··æ·†çŸ©é˜µã€é”™è¯¯åˆ†æç­‰å¯è§†åŒ–

â”œâ”€â”€ data_utils.py # åŠ è½½æ•°æ®é›†ã€æ ‡ç­¾ç¼–ç ã€DataLoader æ„é€ 

â”œâ”€â”€ transforms.py # å®šä¹‰æ•°æ®å¢å¼ºä¸å›¾åƒé¢„å¤„ç†

â”œâ”€â”€ submission.csv # æäº¤æ–‡ä»¶æ ·ä¾‹

â”œâ”€â”€ best_model_resnet18.pth # ResNet18 æœ€ä¼˜æ¨¡å‹æƒé‡

â”œâ”€â”€ best_model_resnet34.pth # ResNet34 æœ€ä¼˜æ¨¡å‹æƒé‡

â””â”€â”€ README.md

## ğŸ“¦ ä¾èµ–ç¯å¢ƒ
bash

pip install -r requirements.txtï¼š

torch>=2.0.0

torchvision>=0.15.0

scikit-learn

matplotlib

seaborn

numpy

pillow

ğŸ å¿«é€Ÿå¼€å§‹

ğŸ”§ 1. è®­ç»ƒæ¨¡å‹
python train_resnet18.py

python train_resnet34.py

ğŸ¤ 2. æ¨¡å‹èåˆ

python ensemble.py

ä¼šç”Ÿæˆ submission.csv æ–‡ä»¶ç”¨äºæäº¤ã€‚

ğŸ“Š 3. è¯„ä¼°æ¨¡å‹

python evaluate.py

å±•ç¤ºï¼š

TTAåéªŒè¯é›†å‡†ç¡®ç‡

æ··æ·†çŸ©é˜µå›¾

å‰9ä¸ªé”™è¯¯åˆ†ç±»æ ·æœ¬

ğŸ“Œ ç»“æœæˆç»©
æ¨¡å‹	éªŒè¯é›†å‡†ç¡®ç‡	Kaggleæäº¤åˆ†æ•°

ResNet18	~91.7%	0.95969

ResNet34	~91.9%	0.95895

èåˆæ¨¡å‹	âœ… 93.6%	âœ… 0.96347


ğŸ“¬ è”ç³»æˆ‘
å¦‚æœ‰ä»»ä½•äº¤æµåˆä½œæˆ–ç–‘é—®ï¼Œæ¬¢è¿è”ç³»æˆ‘ï¼š
ğŸ“® Emailï¼š1011046478@qq.com
